+function($){"use strict";var e=function(e){function a(){var e=!1;return s.params.convertToPopover||s.params.onlyInPopover?(!s.inline&&s.params.input&&(s.params.onlyInPopover?e=!0:$.device.ios?e=!!$.device.ipad:$(window).width()>=768&&(e=!0)),e):e}function t(){return!!(s.opened&&s.container&&s.container.length>0&&s.container.parents(".popover").length>0)}function i(){if(s.opened)for(var e=0;e<s.cols.length;e++)s.cols[e].divider||(s.cols[e].calcSize(),s.cols[e].setValue(s.cols[e].value,0,!1))}function n(e){if(e.preventDefault(),!s.opened&&(s.open(),s.params.scrollToInput&&!a())){var t=s.input.parents(".content");if(0===t.length)return;var i=parseInt(t.css("padding-top"),10),n=parseInt(t.css("padding-bottom"),10),r=t[0].offsetHeight-i-s.container.height(),o=t[0].scrollHeight-i-s.container.height(),c,l=s.input.offset().top-i+s.input[0].offsetHeight;if(l>r){var p=t.scrollTop()+l-r;p+r>o&&(c=p+r-o+n,r===o&&(c=s.container.height()),t.css({"padding-bottom":c+"px"})),t.scrollTop(p,300)}}}function r(e){t()||(s.input&&s.input.length>0?e.target!==s.input[0]&&0===$(e.target).parents(".picker-modal").length&&s.close():0===$(e.target).parents(".picker-modal").length&&s.close())}function o(){s.opened=!1,s.input&&s.input.length>0&&s.input.parents(".page-content").css({"padding-bottom":""}),s.params.onClose&&s.params.onClose(s),s.container.find(".picker-items-col").each(function(){s.destroyPickerCol(this)}),$.stopBodyScroll(!1)}var s=this,c={updateValuesOnMomentum:!1,updateValuesOnTouchmove:!0,rotateEffect:!1,momentumRatio:7,freeMode:!1,scrollToInput:!0,inputReadOnly:!0,toolbar:!0,toolbarCloseText:"取消",title:"请选择",toolbarTemplate:'<div class="toolbar">          <a href="javascript:;" class="cancel close-picker">{{closeText}}</a>          <a href="javascript:;" class="submit close-picker">确认</a>          </div>'};e=e||{};for(var l in c)void 0===e[l]&&(e[l]=c[l]);return s.params=e,s.cols=[],s.initialized=!1,s.inline=!!s.params.container,s.setValue=function(e,a){for(var t=0,i=0;i<s.cols.length;i++)s.cols[i]&&!s.cols[i].divider&&(s.cols[i].setValue(e[t],a),t++)},s.updateValue=function(){for(var e=[],a=[],t=0;t<s.cols.length;t++)s.cols[t].divider||(e.push(s.cols[t].value),a.push(s.cols[t].displayValue));e.indexOf(void 0)>=0||(s.value=e,s.displayValue=a,s.params.onChange&&s.params.onChange(s,s.value,s.displayValue),s.input&&s.input.length>0&&($(s.input).val(s.params.formatValue?s.params.formatValue(s,s.value,s.displayValue):s.value.join(" ")),$(s.input).trigger("change")))},s.initPickerCol=function(e,a){function t(){w=$.requestAnimationFrame(function(){p.updateItems(void 0,void 0,0),t()})}function i(e){if(!x&&!T){e.preventDefault(),T=!0;var a=$.getTouchPosition(e);V=C=a.y,M=(new Date).getTime(),y=!0,P=I=$.getTranslate(p.wrapper[0],"y")}}function n(e){if(T){e.preventDefault(),y=!1;var a=$.getTouchPosition(e);C=a.y,x||($.cancelAnimationFrame(w),x=!0,P=I=$.getTranslate(p.wrapper[0],"y"),p.wrapper.transition(0)),e.preventDefault();I=P+(C-V),E=void 0,I<h&&(I=h-Math.pow(h-I,.8),E="min"),I>k&&(I=k+Math.pow(I-k,.8),E="max"),p.wrapper.transform("translate3d(0,"+I+"px,0)"),p.updateItems(void 0,I,0,s.params.updateValuesOnTouchmove),O=I-H||I,z=(new Date).getTime(),H=I}}function r(e){if(!T||!x)return void(T=x=!1);T=x=!1,p.wrapper.transition(""),E&&("min"===E?p.wrapper.transform("translate3d(0,"+h+"px,0)"):p.wrapper.transform("translate3d(0,"+k+"px,0)")),b=(new Date).getTime();var a,i;b-M>300?i=I:(a=Math.abs(O/(b-z)),i=I+O*s.params.momentumRatio),i=Math.max(Math.min(i,k),h);var n=-Math.floor((i-k)/m);s.params.freeMode||(i=-n*m+k),p.wrapper.transform("translate3d(0,"+parseInt(i,10)+"px,0)"),p.updateItems(n,i,"",!0),s.params.updateValuesOnMomentum&&(t(),p.wrapper.transitionEnd(function(){$.cancelAnimationFrame(w)})),setTimeout(function(){y=!0},100)}function o(e){if(y){$.cancelAnimationFrame(w);var a=$(this).attr("data-picker-value");p.setValue(a)}}var c=$(e),l=c.index(),p=s.cols[l];if(!p.divider){p.container=c,p.wrapper=p.container.find(".picker-items-col-wrapper"),p.items=p.wrapper.find(".picker-item");var u,d,v,m,f,h,k;p.replaceValues=function(e,a){p.destroyEvents(),p.values=e,p.displayValues=a;var t=s.columnHTML(p,!0);p.wrapper.html(t),p.items=p.wrapper.find(".picker-item"),p.calcSize(),p.setValue(p.values[0]||"",0,!0),p.initEvents()},p.calcSize=function(){if(p.values.length){s.params.rotateEffect&&(p.container.removeClass("picker-items-col-absolute"),p.width||p.container.css({width:""}));var e,a;e=0,a=p.container[0].offsetHeight,v=p.wrapper[0].offsetHeight,m=p.items[0].offsetHeight,f=m*p.items.length,h=a/2-f+m/2,k=a/2-m/2,p.width&&(e=p.width,parseInt(e,10)===e&&(e+="px"),p.container.css({width:e})),s.params.rotateEffect&&(p.width||(p.items.each(function(){var a=$(this);a.css({width:"auto"}),e=Math.max(e,a[0].offsetWidth),a.css({width:""})}),p.container.css({width:e+2+"px"})),p.container.addClass("picker-items-col-absolute"))}},p.calcSize(),p.wrapper.transform("translate3d(0,"+k+"px,0)").transition(0);var g=0,w;p.setValue=function(e,a,i){void 0===a&&(a="");var n=p.wrapper.find('.picker-item[data-picker-value="'+e+'"]').index();if(void 0===n||-1===n)return void(p.value=p.displayValue=e);var r=-n*m+k;p.wrapper.transition(a),p.wrapper.transform("translate3d(0,"+r+"px,0)"),s.params.updateValuesOnMomentum&&p.activeIndex&&p.activeIndex!==n&&($.cancelAnimationFrame(w),p.wrapper.transitionEnd(function(){$.cancelAnimationFrame(w)}),t()),p.updateItems(n,r,a,i)},p.updateItems=function(e,a,t,i){void 0===a&&(a=$.getTranslate(p.wrapper[0],"y")),void 0===e&&(e=-Math.round((a-k)/m)),e<0&&(e=0),e>=p.items.length&&(e=p.items.length-1);var n=p.activeIndex;p.activeIndex=e,p.wrapper.find(".picker-selected").removeClass("picker-selected"),s.params.rotateEffect&&p.items.transition(t);var r=p.items.eq(e).addClass("picker-selected").transform("");if((i||void 0===i)&&(p.value=r.attr("data-picker-value"),p.displayValue=p.displayValues?p.displayValues[e]:p.value,n!==e&&(p.onChange&&p.onChange(s,p.value,p.displayValue),s.updateValue())),s.params.rotateEffect){var o=(a-(Math.floor((a-k)/m)*m+k))/m;p.items.each(function(){var e=$(this),t=e.index()*m,i=k-a,n=t-i,r=n/m,o=Math.ceil(p.height/m/2)+1,s=-18*r;s>180&&(s=180),s<-180&&(s=-180),Math.abs(r)>o?e.addClass("picker-item-far"):e.removeClass("picker-item-far"),e.transform("translate3d(0, "+(-a+k)+"px, "+(originBug?-110:0)+"px) rotateX("+s+"deg)")})}},a&&p.updateItems(0,k,0);var y=!0,T,x,V,C,M,b,P,E,I,H,O,z;p.initEvents=function(e){var a=e?"off":"on";p.container[a]($.touchEvents.start,i),p.container[a]($.touchEvents.move,n),p.container[a]($.touchEvents.end,r),p.items[a]("click",o)},p.destroyEvents=function(){p.initEvents(!0)},p.container[0].f7DestroyPickerCol=function(){p.destroyEvents()},p.initEvents()}},s.destroyPickerCol=function(e){e=$(e),"f7DestroyPickerCol"in e[0]&&e[0].f7DestroyPickerCol()},$(window).on("resize",i),s.columnHTML=function(e,a){var t="",i="";if(e.divider)i+='<div class="picker-items-col picker-items-col-divider'+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'">'+e.content+"</div>";else{for(var n=0;n<e.values.length;n++)t+='<div class="picker-item" data-picker-value="'+e.values[n]+'">'+(e.displayValues?e.displayValues[n]:e.values[n])+"</div>";i+='<div class="picker-items-col'+(e.textAlign?"picker-items-col-"+e.textAlign:"")+" "+(e.cssClass||"")+'"><div class="picker-items-col-wrapper">'+t+"</div></div>"}return a?t:i},s.layout=function(){var e="",a="",t;s.cols=[];var i="";for(t=0;t<s.params.cols.length;t++){var n=s.params.cols[t];i+=s.columnHTML(s.params.cols[t]),s.cols.push(n)}a="picker-modal picker-columns"+(s.params.cssClass||"")+(s.params.rotateEffect?" picker-3d":"")+(1===s.params.cols.length?" picker-columns-single":""),e='<div class="'+a+'">'+(s.params.toolbar?s.params.toolbarTemplate.replace(/{{closeText}}/g,s.params.toolbarCloseText).replace(/{{title}}/g,s.params.title):"")+'<div class="picker-modal-inner picker-items">'+i+'<div class="picker-center-highlight"></div></div></div>',s.pickerHTML=e},s.params.input&&(s.input=$(s.params.input),s.input.length>0&&(s.params.inputReadOnly&&s.input.prop("readOnly",!0),s.inline||s.input.on("click",n),s.params.inputReadOnly&&s.input.on("focus mousedown",function(e){e.preventDefault()}))),s.inline||$("html").on("click",r),s.opened=!1,s.open=function(){var e=a();s.opened||(s.layout(),e?(s.pickerHTML='<div class="popover popover-picker-columns"><div class="popover-inner">'+s.pickerHTML+"</div></div>",s.popover=$.popover(s.pickerHTML,s.params.input,!0),s.container=$(s.popover).find(".picker-modal"),$(s.popover).on("close",function(){o()})):s.inline?(s.container=$(s.pickerHTML),s.container.addClass("picker-modal-inline"),$(s.params.container).append(s.container)):(s.container=$($.openPicker(s.pickerHTML)),$(s.container).on("close",function(){o()})),s.container[0].f7Picker=s,s.container.find(".picker-items-col").each(function(){var e=!0;(!s.initialized&&s.params.value||s.initialized&&s.value)&&(e=!1),s.initPickerCol(this,e)}),s.initialized?s.value&&s.setValue(s.value,0):s.params.value&&s.setValue(s.params.value,0)),s.opened=!0,s.initialized=!0,s.params.onOpen&&s.params.onOpen(s)},s.close=function(e){if(s.opened&&!s.inline)return t()?void $.closePicker(s.popover):void $.closePicker(s.container)},s.destroy=function(){s.close(),s.params.input&&s.input.length>0&&(s.input.off("click focus",n),$(s.input).data("picker",null)),$("html").off("click",r),$(window).off("resize",i)},s.inline&&s.open(),s};$(document).on("click",".close-picker",function(){var e=$(".picker-modal.picker-modal-visible");e.length>0&&$.closePicker(e),$.stopBodyScroll(!1)}),$.openPicker=function(e,a,t){$.stopBodyScroll(!0),"function"==typeof a&&(t=a,a=void 0),$.closePicker();var i=$("<div class='picker-container"+(a||"")+"'></div>").appendTo(document.body);i.show(),i.addClass("picker-container-visible");var n=$(e).appendTo(i);return n.width(),n.addClass("picker-modal-visible"),t&&i.on("close",t),n},$.updatePicker=function(e){var a=$(".picker-container-visible");if(!a[0])return!1;a.html("");var t=$(e).appendTo(a);return t.addClass("picker-modal-visible"),t},$.closePicker=function(e,a){"function"==typeof e&&(a=e),$(".picker-modal-visible").removeClass("picker-modal-visible").transitionEnd(function(){$(this).parent().remove(),a&&a()}).trigger("close")},$.fn.picker=function(a){var t=arguments;return this.each(function(){if(this){var i=$(this),n=i.data("picker");if(!n){a=$.extend({input:this},a||{});var r=i.val();void 0===a.value&&""!==r&&(a.value=a.cols&&a.cols.length>1?r.split(" "):[r]);var o=$.extend({input:this},a);n=new e(o),i.data("picker",n)}"string"==typeof a&&n[a].apply(n,Array.prototype.slice.call(t,1))}})}}($);